{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from \"axios\";\nconst formEl = document.querySelector('.js-search-form');\nconst inputEl = document.querySelector('input');\nconst galleryEl = document.querySelector('.gallery');\nconst loaderEl = document.querySelector('.loader');\n\nconst loaderMoreEl = document.querySelector('.js-loader')\nconst BtnMoreEl = document.querySelector('.more--btn');\n\nconst nonExistSpan = document.querySelector('.non-existent');\nlet count = 1;\nlet newCount = 1;\nlet searchValue;\nlet first40Array = [];\nlet second40Array = [];\n\nconst gallery = new SimpleLightbox('.gallery a', {\n    captions: true,\n    captionDelay: 250,\n    fadeSpeed: 250,\n    captionSelector: \"img\",\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n});\n\n\nasync function fetchImagesFromApi(number, value) {\n    const urlFromPixaby = new URLSearchParams({\n        key: '41648594-e525389370aefc2e125a1a54e',\n        q: value,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n        per_page: 80,\n        page: number\n    })\n    try {\n\n        const response = await axios({\n            method: 'get',\n            url: `https://pixabay.com/api/?${urlFromPixaby}`\n        });\n\n        return response;\n\n    } catch (error) {\n        console.error(error.message);\n        BtnMoreEl.classList.add('switcher');\n        return iziToast.info({\n            title: 'Hey!',\n            message: 'We re sorry, but you ve reached the end of search results.',\n        });\n    }\n};\n\n\nasync function response(number, value) {\n    try {\n        const pixabayInformation = await fetchImagesFromApi(number, value)\n        // ділимо наш масив 80 ти елементів на два\n        const first40 = pixabayInformation.data.hits.slice(0, 40);\n\n        // Залишаємо всі інші елементи\n        const remaining = pixabayInformation.data.hits.slice(40);\n\n        // Виводимо результати\n        first40Array = [...first40]\n        second40Array = [...remaining]\n\n        loaderSwitch()\n        izitoast(first40)\n\n        console.log(count)\n        if (count === 1) {\n            console.log(\"count % 2 === 0\", count % 2 === 0)\n            // парсим самі перші 40 елементів\n            galleryEl.innerHTML = markup(first40)\n            gallery.refresh();\n        } else {\n            // парсим перші послідовні 40 елементів\n            galleryEl.insertAdjacentHTML('beforeend', markup(first40));\n            gallery.refresh();\n            scrollToNextGroup();\n        }\n\n    } catch (error) {\n        console.error(error.message);\n    }\n\n};\n\n\nfunction markup(hits) {\n\n    const typset = hits.map(item => `\n    <li class=\"gallery__item\">\n    <a href=\"${item.largeImageURL}\">\n    <img class=\"gallery--img\" src=\"${item.webformatURL}\" alt=\"${item.tags}\" title=\"${item.tags}\"/>\n    </a>\n<ul class=\"gallery__list--characters\">\n  <p>likes: ${item.likes}</p>\n  <p>views: ${item.views}</p>\n  <p>comments: ${item.comments}</p>\n  <p>downloads: ${item.downloads}</p>\n</ul>\n    </li>\n    `).join('')\n\n\n    return typset\n\n};\n\n\nconst izitoast = (value) => {\n\n    try {\n\n\n        if (value.length < 40 & value.length !== 0) {\n            BtnMoreEl.classList.add('switcher');\n            return iziToast.info({\n                title: 'Hey!',\n                message: 'We re sorry, but you ve reached the end of search results.',\n            });\n        }\n        if (value.length === 0) {\n            BtnMoreEl.classList.add('switcher');\n            return iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n        }\n\n        BtnMoreEl.classList.remove('switcher');\n\n\n    } catch (error) {\n        console.error(error.message);\n    }\n\n};\n\n\n\nconst saveInputValue = (e) => {\n    nonExistSpan.textContent = e;\n    return nonExistSpan.textContent;\n};\n\nconst loaderSwitch = () => {\n\n    loaderEl.classList.toggle('switcher')\n\n};\n\nconst loaderMoreSwitch = () => {\n    loaderMoreEl.classList.toggle('non-existent')\n\n}\n\nfunction getGalleryItemHeight() {\n    const firstGalleryItem = document.querySelector('.gallery__item');\n    if (firstGalleryItem) {\n        const rect = firstGalleryItem.getBoundingClientRect();\n        return Math.round(rect.height);\n    }\n    return 0;\n}\n\nfunction scrollToNextGroup() {\n    const galleryItemHeight = getGalleryItemHeight()\n\n    if (galleryItemHeight > 0) {\n        window.scrollBy({\n            top: galleryItemHeight * 2,\n            left: 0,\n            behavior: 'smooth',\n        });\n    }\n}\n\n\n\n\nloaderSwitch();\n\n\nformEl.addEventListener('submit', (event) => {\n    event.preventDefault()\n    newCount = 1;\n    count = 1;\n    loaderSwitch()\n    response(1, inputEl.value)\n    saveInputValue(inputEl.value);\n    formEl.reset()\n});\nBtnMoreEl.addEventListener('click', (event) => {\n    loaderMoreSwitch()\n    count += 1;\n    searchValue = nonExistSpan.textContent;\n    loaderSwitch()\n    loaderMoreSwitch()\n\n    if (count % 2 === 0) {\n        //  зараз парсим другі 40 елементів\n\n        galleryEl.insertAdjacentHTML('beforeend', markup(second40Array));\n        izitoast(second40Array);\n        gallery.refresh();\n        loaderSwitch();\n        newCount += 1;\n        //   'я побіг перевіряти чи буде доступ до наступного хттп запиту'\n        fetchImagesFromApi(newCount, searchValue)\n    } else {\n\n        response(newCount, searchValue)\n    }\n    scrollToNextGroup()\n});\n\n"],"names":["formEl","inputEl","galleryEl","loaderEl","loaderMoreEl","BtnMoreEl","nonExistSpan","count","newCount","searchValue","first40Array","second40Array","gallery","SimpleLightbox","fetchImagesFromApi","number","value","urlFromPixaby","axios","error","iziToast","response","pixabayInformation","first40","remaining","loaderSwitch","izitoast","markup","scrollToNextGroup","hits","item","saveInputValue","loaderMoreSwitch","getGalleryItemHeight","firstGalleryItem","rect","galleryItemHeight","event"],"mappings":"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"}